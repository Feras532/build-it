<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>post</title>
</head>
<body>
    {{!-- post to display --}}
    {{!-- Title, Note, Pic --}}
    <div class="header" style="display: flex; justify-content:space-between">
        <button class="backButton">Go Back {{!Change to an arrow}}</button>
        <form action="community/{{post._id}}/rate" id=""><button>Leave a rating</button></form>{{!Change to stars (hard)}}
    </div>

    <div class="post" style="display: flex;">
        <div class="img_stats" style="display: flex; flex-direction: column;">
            <img src={{post.Image}} alt="">
            <div id="userAndStats" style="display: flex; flex-direction:column;">
                <div id="user"><img src={{user.image}} alt=""><span>/{{user.username}}</span></div>
                <div class="note">{{post.Note}}</div>
                <div class="date">Created At: <span>{{post.formattedDate}}</span></div>
                <div class="stats">
                    <div id="rating" style="display:flex; flex-direction:column;"><img src="assets/ratingStar.png" alt=""><span>{{post.Rating.value}}</span></div>
                    <div id="views" style="display:flex; flex-direction:column;"><img src="assets/views.png" alt=""><span>{{post.Views}}</span></div>
                </div>
            </div>
        </div>

        <div>
            <div class="title">{{post.Title}}</div>
            <div class="body">{{post.Body}}</div>
            <div class="comment-section" style="display: flex; flex-direction:column;">
                <div class="comment-header">
                    <span >Comments: </span> 
                    {{#if post.Comments}}
                    <p>{{post.Comments.length}}</p>
                    {{#else}}
                    <p>0</p>
                    {{/if}}
                </div>
                <div class="comments">
                    <form action="community/{{post._id}}/createComment">
                        <input type="text" name="comment" placeholder="Leave a comment on this post">{{! ensureAuth before creating}}
                    </form>
                    {{#if post.Comments}}
                        <div class="scrollable" style="overflow:auto height:30em" >
                            {{#each post.Comments}}
                                <div class="comment" style="display: flex; flex-direction:column; gap:0.2em;">
                                    <div class="comment-noDate" style="display: flex;">
                                    <img class="comment-img" src={{u.image}}>
                                    <div class="comment-name-title">
                                        <span class="comment-name">{{u.username}}</span> {{!Did not make the comment entity yet.}}
                                        <span class="comment-content">{{Content}}</span>
                                    </div>
                                    <div class="comment-date">{{DateMade}}</div>
                                    </div>
                                </div>

                            {{/each}}
                        </div>
                    {{#else}}

                            <p class="noComments">No comments</p>                        

                    {{/if}}
                        
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>